(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{366:function(t,s,a){"use strict";a.r(s);var e=a(44),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"web8-php文件包含"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web8-php文件包含"}},[t._v("#")]),t._v(" Web8 PHP文件包含")]),t._v(" "),a("p",[t._v("U1S1，这个题确实不太简单。而且考察的不只是文件包含。而且有一些比较恶心的阻碍(具体看后续)。")]),t._v(" "),a("h2",{attrs:{id:"了解相关函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#了解相关函数"}},[t._v("#")]),t._v(" 了解相关函数")]),t._v(" "),a("p",[t._v("在这到题里面，会用到如下几个PHP函数。")]),t._v(" "),a("h5",{attrs:{id:"_1-include"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-include"}},[t._v("#")]),t._v(" 1.include()")]),t._v(" "),a("p",[t._v("这个函数用于包含并运行指定文件。")]),t._v(" "),a("p",[t._v("例子：")]),t._v(" "),a("p",[t._v("Vars.php：")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$color")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'green'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fruit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'apple'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])])]),a("p",[t._v("test.php：")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"A '),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$color")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fruit")])]),t._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// A")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'vars.php'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"A '),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$color")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fruit")])]),t._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// A green apple")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])])]),a("p",[t._v("运行结果：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("A \nA green apple\n")])])]),a("h5",{attrs:{id:"_2-request"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-request"}},[t._v("#")]),t._v(" 2.$_REQUEST")]),t._v(" "),a("p",[a("code",[t._v("$_REQUEST[string]")]),t._v(" 可以获取到GET和POST method请求的参数。")]),t._v(" "),a("p",[t._v("其中string为参数名称，字符串类型(string)")]),t._v(" "),a("h5",{attrs:{id:"_3-eval"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-eval"}},[t._v("#")]),t._v(" 3.eval")]),t._v(" "),a("p",[a("code",[t._v("eval(string)")]),t._v("用于将字符串(string)作为代码执行。")]),t._v(" "),a("p",[t._v("案例：来自PHP手册 - php.net")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$string")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'cup'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'coffee'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'This is a $string with my $name in it.'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("eval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"\\$str = \\"'),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")])]),t._v('\\";"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v(" \n")])])]),a("p",[t._v("输出：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("This is a $string with my $name in it.\nThis is a cup with my coffee in it.\n\n")])])]),a("p",[a("strong",[t._v("Tips：字符串中任何代码都会被作为代码执行，除了为加转意符号的变量")])]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.php.net/manual/zh/function.eval.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("Eval函数 - PHP手册"),a("OutboundLink")],1)]),t._v(" "),a("h5",{attrs:{id:"_4-show-source-highlight-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-show-source-highlight-file"}},[t._v("#")]),t._v(" 4.show_source() / highlight_file()")]),t._v(" "),a("h2",{attrs:{id:"解题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解题"}},[t._v("#")]),t._v(" 解题")]),t._v(" "),a("p",[t._v("首先打开场景，会看到一串代码。"),a("img",{attrs:{src:"http://media.cdn.461blog.cn/uPic/20210521-12-45-%E6%88%AA%E5%B1%8F2021-05-21%20%E4%B8%8B%E5%8D%8812.45.55.png",alt:"截屏2021-05-21 下午12.45.55"}})]),t._v(" "),a("p",[t._v("代码中通过"),a("code",[t._v("include( )")]),t._v("函数引入了flag.php，如果我们直接访问flag.php的话是看不到flag的。")]),t._v(" "),a("p",[t._v("然后用"),a("code",[t._v("$_REQUEST")]),t._v("获取了参数名为hello的请求的值作为变量a的值。"),a("code",[t._v("$_REQUEST")]),t._v("前面的 "),a("code",[t._v("@")]),t._v(" 起到了屏蔽所有错误提示信息的作用（这就是前文所述比较恶心的地方，因为如果后面出现错误没法通过错误提示判断）。")]),t._v(" "),a("p",[t._v("之后用 "),a("code",[t._v("eval( )")]),t._v("函数运行了代码 "),a("code",[t._v("var_dump( （此处是$a的内容） );")]),t._v("。")]),t._v(" "),a("p",[t._v("加入$a = 1的话，就是运行"),a("code",[t._v("vur_dump(1)")]),t._v(".")]),t._v(" "),a("p",[t._v("所以我们需要先截断"),a("code",[t._v("vur_dump( )")]),t._v("，之后"),a("code",[t._v("show_source( )")]),t._v("或者"),a("code",[t._v("highlight_file( )")]),t._v("，查看一下源代码。")]),t._v(" "),a("p",[t._v("tips：这里会有很多人认为直接传入"),a("code",[t._v("show_source( )")]),t._v("或者"),a("code",[t._v("highlight_file( )")]),t._v("，而忽略截断"),a("code",[t._v("vur_dump( )")])]),t._v(" "),a("p",[t._v("所以说"),a("code",[t._v("$a")]),t._v("（参数hello被传入）的值应为"),a("code",[t._v("1);highlight_file('flag.php'")]),t._v("。这样运行的代码就是"),a("code",[t._v("var_dump(1);highlight_file('flag.php');")])]),t._v(" "),a("p",[t._v("所以打开网址"),a("code",[t._v("http://场景地址/index.php?hello=1);highlight_file(%27flag.php%27")]),t._v("就可以获得源代码。通过查看源代码可以再注释里面看到flag。")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://media.cdn.461blog.cn/uPic/20210521-12-48-%E6%88%AA%E5%B1%8F2021-05-21%20%E4%B8%8B%E5%8D%8812.48.07.png",alt:"截屏2021-05-21 下午12.48.07"}})])])}),[],!1,null,null,null);s.default=r.exports}}]);